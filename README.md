# Data Mining Final Course Design: Character Level LSTM for Injection Detection

## Introduction
Referenced paper 'Malicious Web Request Detection Using Character-Level CNN' implement Character Level LSTM for Injection Detection. 
A character-level embedding layer was added before the Embedding layer, which allowed our model to learn the intrinsic relationship between the characters of the request parameters. In addition, we modified the LSTM filter so that it can extract fine-grained features of request parameters. We also realized flask function.

## File Directory
```
.
├── Preprocessing.py
├── README.md
├── Traning.py
├── app.py
├── static
│   ├── style.css
│   └── ...
├── templates
│   ├── index.html
│   └── results.html
└── data
│   ├── test.txt
│   ├── anomalousTraffic.txt
│   ├── anomalous_parsed.txt
│   ├── normalTraffic.txt
│   ├── normal_parsed.txt
│   ├── model.h5
│   └── results.html
└── Data Mining Final Course Report.pdf
```

## Environment configuration
- python == 3.7.4
- tensorflow==1.3.0
- keras==2.3.1
- numpy==1.17.1


## Data set
The project uses the HTTP dataset CSIC 2010. CSIC 2010 contains thousands of web requests that are automatically generated by generating traffic to e-commerce web applications. The dataset contains 36,000 HTTP requests marked as normal and about 25,000 requests marked as abnormal. Attack types include SQL injection, buffer overflow, information collection, XSS, etc. The data set is preprocessed according to the neural network model. Some functions included in the HTTP request (these functions cannot help distinguish normal requests from abnormal requests) have been removed, such as protocols, userAgent, pragma, cacheControl, accept, acceptEncoding, acceptCharset, acceptLanguage, connection and other functions.

## result
After ten rounds of training, the accuracy rate can reach 96.95%
<img style="width:600px;height:200px" src="https://pic1.superbed.cn/item/5df9919176085c3289803dab.jpg"/>
